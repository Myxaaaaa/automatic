Notify Forwarder (Android)

Что это
- Нативное Android‑приложение, которое перехватывает уведомления выбранных приложений и отправляет их на тестовый POST URL (`https://httpbin.org/post`).
- Для работы требуется выдать доступ к уведомлениям в системных настройках.

Основные возможности
- Экран выбора приложений (чекбоксы) — сохраняется локально.
- Сервис `NotificationListenerService` — перехватывает уведомления, фильтрует по выбранным пакетам.
- Парсинг суммы из текста (простая регэксп‑маска).
- Отправка JSON по HTTP POST. Тестовый эндпоинт по умолчанию.
- Кнопка «Тест уведомление» — публикует локальное уведомление, чтобы быстро проверить пайплайн.

- Подключение платформы через QR
  - Меню → «Сканировать QR платформы».
  - Формат QR (JSON):
    ```json
    {
      "endpoint": "http://<HOST>:3001/notify",
      "secret": "test-secret",
      "deviceId": "android-device-01",
      "account": "Карта •••• 1234"
    }
    ```
  - Если `deviceId` не указан, приложение сгенерирует UUID.
  - В `account` можно передать описание реквизитов (карта/счёт) — отображается на платформе.
  - После сканирования приложение сохранит URL, секрет, устройство и реквизиты и будет слать `Authorization: Bearer <secret>`.
- На экране отображается текущая связка (endpoint / deviceId / реквизиты).

Локальная тестовая платформа
- В корне репозитория есть `platform/` (Node.js Express).
- Запуск:
  - `cd platform && npm i && npm run start`
  - По умолчанию порт `3001`, секрет `test-secret` (можно задать через `SECRET`).
- Создать заявку:
  - `POST http://localhost:3001/deal` body: `{ "amount": "1234,56" }`
- Подтверждение по пушу:
  - Приложение отправляет POST на `/notify` с той же суммой → платформа помечает заявку как `confirmed`.

Сборка локально (Android Studio)
1) Откройте директорию `android-notify/` в Android Studio.
2) Запустите сборку Build → Make Project.
3) Соберите APK: Build → Build Bundle(s) / APK(s) → Build APK(s).
4) APK будет в `app/build/outputs/apk/debug/app-debug.apk`.

Сборка через GitHub Actions (получить ссылку на APK)
1) Залейте весь репозиторий в GitHub.
2) Перейдите во вкладку Actions → Android Debug APK → Run workflow (или дождитесь автозапуска на push).
3) После завершения появится артефакт `app-debug-apk` — скачайте `app-debug.apk`.

Проверка
- Установите APK на устройство (разрешите установку из неизвестных источников).
- Откройте приложение, нажмите «Открыть доступ» и включите доступ к уведомлениям для Notify Forwarder.
- Выберите приложения в списке.
- Нажмите «Тест уведомление» — в логах (Logcat) вы увидите отправку POST. На `https://httpbin.org/` ответ придёт 200.

Замена тестового URL
- По умолчанию используется `https://httpbin.org/post`. Для интеграции поменяйте URL программно в `AppPreferences.setEndpointUrl(context, "https://ваш-сервер/endpoint")` или расширьте UI под ввод URL.

Формат отправляемого JSON
{
  "package": "com.example.app",
  "title": "Заголовок",
  "text": "Текст уведомления",
  "postedAt": "2025-01-01T12:34:56.789+03:00",
  "amount": "1234,56" // если найдена
}


